# PySpark Products and Categories Application - –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞
- ‚úÖ **–ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –ø–∞—Ä "–ò–º—è –ø—Ä–æ–¥—É–∫—Ç–∞ ‚Äì –ò–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `get_products_with_categories()`
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** - –ø—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å NULL –≤ category_name
- ‚úÖ **–û–¥–∏–Ω –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** - –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º DataFrame
- ‚úÖ **–¢–µ—Å—Ç—ã** - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (10 —Ç–µ—Å—Ç–æ–≤)

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ **SQL –ø–æ–¥—Ö–æ–¥** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQL –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å: ProductsCategoriesProcessor

```python
class ProductsCategoriesProcessor:
    def get_products_with_categories(self, products_df, categories_df, product_categories_df):
        """–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ - —Ä–µ—à–∞–µ—Ç –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É"""
        
    def get_products_without_categories(self, products_df, product_categories_df):
        """–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ - —Ç–æ–ª—å–∫–æ –ø—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
        
    def get_all_products_and_categories(self, products_df, categories_df, product_categories_df):
        """–ê–ª–∏–∞—Å –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞"""
```

### SQL —Ä–µ—à–µ–Ω–∏–µ

```sql
SELECT 
    p.product_name,
    c.category_name
FROM products p
LEFT JOIN product_categories pc ON p.product_id = pc.product_id
LEFT JOIN categories c ON pc.category_id = c.category_id
ORDER BY p.product_name, c.category_name
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- `LEFT JOIN` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `ORDER BY` –¥–ª—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
- –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å —Ä–µ—à–∞–µ—Ç –≤—Å—é –∑–∞–¥–∞—á—É

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **products_df**: product_id, product_name
- **categories_df**: category_id, category_name  
- **product_categories_df**: product_id, category_id

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **result_df**: product_name, category_name (NULL –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π)

## üß™ –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
1. ‚úÖ **–ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä –ø—Ä–æ–¥—É–∫—Ç-–∫–∞—Ç–µ–≥–æ—Ä–∏—è
2. ‚úÖ **–ü—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ NULL –∑–Ω–∞—á–µ–Ω–∏–π
3. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–ª–æ–Ω–æ–∫
4. ‚úÖ **–ü—É—Å—Ç—ã–µ DataFrame** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. ‚úÖ **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** - –ø—Ä–æ–¥—É–∫—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
6. ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - —Ñ—É–Ω–∫—Ü–∏—è create_sample_data()

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```python
# –ü—Ä–æ–¥—É–∫—Ç—ã
products_data = [
    (1, "Laptop"), (2, "Mouse"), (3, "Keyboard"),
    (4, "Monitor"), (5, "Headphones"), (6, "Tablet"),
    (7, "Phone"), (8, "Camera")
]

# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
categories_data = [
    (1, "Electronics"), (2, "Computer Accessories"),
    (3, "Audio"), (4, "Mobile Devices"), (5, "Photography")
]

# –°–≤—è–∑–∏
product_categories_data = [
    (1, 1), (1, 2),  # Laptop -> Electronics, Computer Accessories
    (2, 1), (2, 2),  # Mouse -> Electronics, Computer Accessories
    # ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
]
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä
```python
from pyspark.sql import SparkSession
from pyspark_app.products_categories import ProductsCategoriesProcessor, create_sample_data

# –°–æ–∑–¥–∞–Ω–∏–µ Spark —Å–µ—Å—Å–∏–∏
spark = SparkSession.builder.appName("Demo").master("local").getOrCreate()

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
processor = ProductsCategoriesProcessor(spark)

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
products_df, categories_df, product_categories_df = create_sample_data(spark)

# –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
result_df = processor.get_products_with_categories(
    products_df, categories_df, product_categories_df
)

# –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
result_df.show()
```

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```
+------------+------------------+
|product_name|category_name     |
+------------+------------------+
|Camera      |Electronics       |
|Camera      |Photography       |
|Headphones  |Audio             |
|Headphones  |Electronics       |
|Keyboard    |Computer Accessories|
|Keyboard    |Electronics       |
|Laptop      |Computer Accessories|
|Laptop      |Electronics       |
|Monitor     |Computer Accessories|
|Monitor     |Electronics       |
|Mouse       |Computer Accessories|
|Mouse       |Electronics       |
|Phone       |Electronics       |
|Phone       |Mobile Devices    |
|Tablet      |Electronics       |
|Tablet      |Mobile Devices    |
+------------+------------------+
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
pyspark_products_categories/
‚îú‚îÄ‚îÄ pyspark_app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ products_categories.py      # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ test_products_categories.py # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ example_usage.py                # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ README.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt                # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ run_tests.py                    # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ PROJECT_SUMMARY.md              # –≠—Ç–∞ —Å–≤–æ–¥–∫–∞
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **PySpark**: 3.0+ (–æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
- **Python**: 3.7+ (—è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è)
- **Java**: 8+ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è Spark)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
pip install pyspark
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
python run_tests.py
```

### –ó–∞–ø—É—Å–∫ –¥–µ–º–æ
```bash
python example_usage.py
```

## üéØ –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ - –î–µ—Ç–∞–ª–∏

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 1: –í—Å–µ –ø–∞—Ä—ã "–ò–º—è –ø—Ä–æ–¥—É–∫—Ç–∞ ‚Äì –ò–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
**–†–µ—à–µ–Ω–∏–µ:** SQL –∑–∞–ø—Ä–æ—Å —Å LEFT JOIN –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 2: –ü—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
**–†–µ—à–µ–Ω–∏–µ:** LEFT JOIN –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç NULL –≤ category_name –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑ —Å–≤—è–∑–µ–π.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 3: –û–¥–∏–Ω –¥–∞—Ç–∞—Ñ—Ä–µ–π–º
**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –æ–¥–Ω–æ–º DataFrame —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ product_name –∏ category_name.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 4: –¢–µ—Å—Ç—ã
**–†–µ—à–µ–Ω–∏–µ:** 10 —Ç–µ—Å—Ç–æ–≤ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQL –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- LEFT JOIN –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ product_id –∏ category_id

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö DataFrame
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

## üèÜ –ò—Ç–æ–≥

**–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–∞–µ—Ç –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É:**

1. ‚úÖ **–ú–µ—Ç–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω** - `get_products_with_categories()`
2. ‚úÖ **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –ø–∞—Ä—ã** - –ø—Ä–æ–¥—É–∫—Ç-–∫–∞—Ç–µ–≥–æ—Ä–∏—è
3. ‚úÖ **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** - NULL –∑–Ω–∞—á–µ–Ω–∏—è
4. ‚úÖ **–û–¥–∏–Ω –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** - –≤—Å–µ –≤ –æ–¥–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
5. ‚úÖ **–¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã** - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
6. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
7. ‚úÖ **–ü—Ä–∏–º–µ—Ä—ã** - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!** üöÄ
